# Master Praktikum Deep Learning: Inpainting Detection
This repo contains the skript, notebooks and models resulting from the master project "Inpainting Detection" at the Ruhr University Bochum in the summer term 2023.

## Objective of the project
The objective of the second project of the seminar was to develop an effective image inpainting detector, with a specific focus on understanding and addressing the noise patterns found in inpainted images. Furthermore the project sought to answer the question if the noise patterns characteristic of modern inpainting pipelines could be effectively learned and detected without the use of specialized model architectures.

## Dataset
We trained our models on two datasets. 
1) The first dataset was provided to us.
   The dataset can be found at: https://ruhr-uni-bochum.sciebo.de/f/1777053235 (only square masks). 
    Files ending in *realfake.webp are inpainted using the entire model.
    Files ending in *fakefake.webp are re-encoded using the latent autoencoder and then blended using the mask (*.mask.webp).
2)  The second dataset is an composition of the first one and additional generated data. The additional data can be found on [huggingface](https://huggingface.co/datasets/hakimgunther/inpainting). In this dataset the originial image is included (*.original.webp) as well as the inpainted (*.inpainted.webp) image that was generated by the difussion model.

## Files in this repository
Listing of all relevant files for this project.
- [report.pdf](./report.pdf): The report of the project
- [baseline](./baseline/): ...
- [Nix](./Nix/): ...
- [data_generation](./data_generation/): scripts that were used to generate the additional data
  - [inpainting.py](./data_generation/inpainting.py): generation of the first data set
  - [qmd_masks.py](./data_generation/qmd_masks.py): generation of images with the QuickDraw dataset
  - [seg_masks.py](./data_generation/seg_masks.py): generation of images with the MaskFormer classifier
  - [yolo_masks.py](./data_generation/yolo_masks.py): generation of images with the YOLO classifier
  - [generate_SD2.1.py](./data_generation/generate_SD2.1.py): generation of inpainted images with stable diffusion 2.1